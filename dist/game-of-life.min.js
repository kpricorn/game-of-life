/*! game-of-life 13-09-2013 */
(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define(["lodash"],function(b){var c,d,e,f;return d=b.flatten(function(){var a,b;for(b=[],e=a=-1;1>=a;e=++a)b.push(function(){var a,b;for(b=[],f=a=-1;1>=a;f=++a)b.push([e,f]);return b}());return b}(),!0),c=function(){function c(b){this.field=null!=b?b:{},this.turn=a(this.turn,this),this.isAlive=a(this.isAlive,this),this.livingNeighbours=a(this.livingNeighbours,this),this.play=a(this.play,this),this.neighboursCoords=a(this.neighboursCoords,this),this.candidates=a(this.candidates,this)}return c.prototype.cells=function(){var a=this;return Object.keys(this.field).map(function(b){return a.field[b]})},c.prototype.candidates=function(){var a,c;return b.flatten(function(){var b,d,e,f,g;for(e=this.cells(),g=[],b=0,d=e.length;d>b;b++)f=e[b],a=f[0],c=f[1],g.push(this.neighboursCoords(a,c));return g}.call(this),!0)},c.prototype.neighboursCoords=function(a,b){var c,e,f,g,h,i;for(i=[],f=0,g=d.length;g>f;f++)h=d[f],c=h[0],e=h[1],i.push([a+c,b+e]);return i},c.prototype.allDead=function(){return 0===Object.keys(this.field).length},c.prototype.play=function(){var a;for(a=[];!this.allDead();)a.push(this.turn());return a},c.prototype.livingNeighbours=function(a,c){var d=this;return b.select(this.neighboursCoords(a,c),function(a){var b,c;return b=a[0],c=a[1],null!=d.field[""+b+"/"+c]})},c.prototype.isAlive=function(a,b){var c;return null!=this.field[""+a+"/"+b]?1<(c=this.livingNeighbours(a,b).length)&&4>c:3===this.livingNeighbours(a,b).length},c.prototype.turn=function(){var a=this;return this.field=b.object(b.select(this.candidates(),function(b){var c,d;return c=b[0],d=b[1],a.isAlive(c,d)}).map(function(a){var b,c;return b=a[0],c=a[1],[""+b+"/"+c,[b,c]]}))},c}(),{Game:c}})}).call(this);