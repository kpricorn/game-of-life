/*! game-of-life 13-09-2013 */
(function(){var a,b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}};d=require("lodash"),a=d.flatten(function(){var a,d;for(d=[],b=a=-1;1>=a;b=++a)d.push(function(){var a,d;for(d=[],c=a=-1;1>=a;c=++a)d.push([b,c]);return d}());return d}(),!0),exports.Game=function(){function b(a){this.field=null!=a?a:{},this.turn=e(this.turn,this),this.livingNeighbours=e(this.livingNeighbours,this),this.play=e(this.play,this),this.neighboursCoords=e(this.neighboursCoords,this),this.candidates=e(this.candidates,this)}return b.prototype.cells=function(){var a=this;return Object.keys(this.field).map(function(b){return a.field[b]})},b.prototype.candidates=function(){var a,b;return d.flatten(function(){var c,d,e,f,g;for(e=this.cells(),g=[],c=0,d=e.length;d>c;c++)f=e[c],a=f[0],b=f[1],g.push(this.neighboursCoords(a,b));return g}.call(this),!0)},b.prototype.neighboursCoords=function(b,c){var d,e,f,g,h,i;for(i=[],f=0,g=a.length;g>f;f++)h=a[f],d=h[0],e=h[1],i.push([b+d,c+e]);return i},b.prototype.allDead=function(){return 0===Object.keys(this.field).length},b.prototype.play=function(){var a;for(a=[];!this.allDead();)a.push(this.turn());return a},b.prototype.livingNeighbours=function(a,b){var c=this;return d.select(this.neighboursCoords(a,b),function(a){var b,d;return b=a[0],d=a[1],null!=c.field[""+b+"/"+d]})},b.prototype.isAlive=function(a,b){var c;return 3<=(c=this.livingNeighbours(a,b).length)&&4>=c},b.prototype.turn=function(){var a=this;return this.field=d.object(d.select(this.candidates(),function(b){var c,d;return c=b[0],d=b[1],a.isAlive(c,d)}).map(function(a){var b,c;return b=a[0],c=a[1],[""+b+"/"+c,[b,c]]}))},b}()}).call(this);